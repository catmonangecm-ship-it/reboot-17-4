<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Bot Trading Multi-Crypto Pro</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/ethers/5.7.2/ethers.umd.min.js"></script>
    <style>
        body {
            background: linear-gradient(to bottom right, #0f172a, #581c87, #0f172a);
            min-height: 100vh;
        }
        .animate-spin {
            animation: spin 1s linear infinite;
        }
        @keyframes spin {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }
        .pulse {
            animation: pulse 2s cubic-bezier(0.4, 0, 0.6, 1) infinite;
        }
        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: .5; }
        }
    </style>
</head>
<body class="text-white p-4 md:p-6">
    <div class="max-w-7xl mx-auto">
        <!-- Header -->
        <div class="flex flex-col md:flex-row justify-between items-start md:items-center gap-4 mb-8">
            <div>
                <h1 class="text-3xl md:text-4xl font-bold bg-gradient-to-r from-yellow-400 to-orange-500 bg-clip-text text-transparent">
                    Bot Trading Multi-Crypto Pro
                </h1>
                <p class="text-gray-400 mt-2">Trading r√©el PancakeSwap ‚Ä¢ Prix temps r√©el Binance ‚Ä¢ Sans commission</p>
            </div>
            
            <div class="flex gap-3">
                <button onclick="connectWallet()" id="connectBtn" class="flex items-center gap-2 px-6 py-3 rounded-lg font-semibold transition-all bg-gradient-to-r from-yellow-400 to-orange-500 hover:from-yellow-500 hover:to-orange-600">
                    <span>üëõ</span>
                    <span id="walletText">Connecter MetaMask</span>
                </button>
            </div>
        </div>

        <!-- S√©lection Crypto -->
        <div id="cryptoSelector" class="bg-slate-800/50 backdrop-blur-sm border border-slate-700 rounded-xl p-6 mb-6 hidden">
            <div class="flex justify-between items-center mb-4">
                <h3 class="text-xl font-bold">S√©lectionner la Crypto √† Trader</h3>
                <button onclick="fetchCryptoList()" id="refreshBtn" class="flex items-center gap-2 px-4 py-2 bg-blue-600 hover:bg-blue-700 rounded-lg transition-all">
                    <span id="refreshIcon">üîÑ</span>
                    <span id="refreshText">Actualiser</span>
                </button>
            </div>
            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                <div>
                    <label class="block text-sm text-gray-400 mb-2">
                        Cryptomonnaie <span id="cryptoCount"></span>
                    </label>
                    <select id="cryptoSelect" onchange="changeCrypto()" class="w-full bg-slate-700 border border-slate-600 rounded-lg px-4 py-3 focus:outline-none focus:border-yellow-400 text-lg font-semibold cursor-pointer">
                        <option>Chargement...</option>
                    </select>
                    <p class="text-xs text-gray-400 mt-2">üíé = Trading r√©el disponible</p>
                    <p class="text-xs text-green-400 mt-1">‚úÖ Prix en temps r√©el via WebSocket Binance</p>
                </div>
                
                <div>
                    <label class="block text-sm text-gray-400 mb-2">Mode de Trading</label>
                    <select id="tradingMode" onchange="changeTradingMode()" class="w-full bg-slate-700 border border-slate-600 rounded-lg px-4 py-3 focus:outline-none focus:border-yellow-400 text-lg font-semibold cursor-pointer">
                        <option value="real">üíé Mode R√©el (PancakeSwap)</option>
                    </select>
                    <p class="text-xs text-green-400 mt-2" id="modeInfo">‚úÖ Trades r√©els avec vraie ex√©cution</p>
                </div>
            </div>
        </div>

        <!-- Approbation USDT -->
        <div id="approvalSection" class="bg-gradient-to-r from-orange-400/20 to-red-500/20 border-2 border-orange-400 rounded-xl p-6 mb-6 hidden">
            <h3 class="text-xl font-bold mb-4 flex items-center gap-2">
                <span>‚ö†Ô∏è</span>
                Approuver USDT pour le Trading R√©el
            </h3>
            <p class="text-gray-300 mb-4">
                Pour trader en mode r√©el sur PancakeSwap, vous devez d'abord approuver le contrat √† utiliser vos USDT.
                <br />
                <span class="text-sm text-gray-400">Cette op√©ration est n√©cessaire une seule fois. Frais de gas: ~0.0003 BNB</span>
            </p>
            <button onclick="approveUSDT()" id="approveBtn" class="px-8 py-3 bg-gradient-to-r from-orange-400 to-red-500 hover:from-orange-500 hover:to-red-600 rounded-lg font-semibold transition-all">
                Approuver USDT
            </button>
        </div>

        <!-- Capital Trading -->
        <div id="capitalSection" class="bg-gradient-to-r from-yellow-400/20 to-orange-500/20 border-2 border-yellow-400 rounded-xl p-6 mb-6 hidden">
            <h3 class="text-xl font-bold mb-4 flex items-center gap-2">
                <span>üéØ</span>
                D√©finir votre capital de trading en USDT
            </h3>
            <p class="text-gray-300 mb-4">
                Entrez le montant en USDT que vous souhaitez utiliser pour le trading automatique.
                <br />
                <span class="text-sm text-gray-400">Solde disponible: <span id="availableBalance">0</span> USDT</span>
            </p>
            <div class="flex gap-4">
                <input type="number" id="capitalInput" placeholder="Ex: 100" step="10" min="10" class="flex-1 bg-slate-700 border border-slate-600 rounded-lg px-4 py-3 focus:outline-none focus:border-yellow-400">
                <button onclick="setCapital()" class="px-8 py-3 bg-gradient-to-r from-yellow-400 to-orange-500 hover:from-yellow-500 hover:to-orange-600 rounded-lg font-semibold transition-all">
                    Valider
                </button>
            </div>
            <p class="text-xs text-orange-400 mt-2">‚ö†Ô∏è Recommand√©: Commencez avec un petit montant (50-200 USDT)</p>
        </div>

        <!-- Stats Cards -->
        <div id="statsCards" class="grid grid-cols-2 md:grid-cols-4 gap-4 mb-8 hidden">
            <div class="bg-slate-800/50 backdrop-blur-sm border border-slate-700 rounded-xl p-4">
                <p class="text-gray-400 text-xs">Capital USDT</p>
                <p class="text-xl font-bold mt-1 text-green-400">$<span id="capitalDisplay">0</span></p>
                <p class="text-xs text-gray-500">Solde: $<span id="balanceDisplay">0</span></p>
            </div>
            
            <div class="bg-slate-800/50 backdrop-blur-sm border border-slate-700 rounded-xl p-4">
                <p class="text-gray-400 text-xs">Prix <span id="cryptoName">BTC</span></p>
                <p class="text-xl font-bold mt-1" id="priceDisplay">
                    <span class="text-green-400">üü¢</span> $<span id="currentPrice">...</span>
                </p>
                <p class="text-xs" id="priceChangeDisplay">Chargement...</p>
            </div>
            
            <div class="bg-slate-800/50 backdrop-blur-sm border border-slate-700 rounded-xl p-4">
                <p class="text-gray-400 text-xs">Profit Net</p>
                <p class="text-xl font-bold mt-1 text-green-400">$<span id="profitDisplay">0.00</span></p>
                <p class="text-xs text-gray-400">(<span id="profitPercent">0</span>%)</p>
            </div>
            
            <div class="bg-slate-800/50 backdrop-blur-sm border border-slate-700 rounded-xl p-4">
                <p class="text-gray-400 text-xs">Trades R√©ussis</p>
                <p class="text-xl font-bold mt-1 text-yellow-400"><span id="successRate">0</span>%</p>
                <p class="text-xs text-gray-400"><span id="totalTrades">0</span> trades</p>
            </div>
        </div>

        <!-- Indicateurs Techniques -->
        <div id="indicatorsSection" class="bg-slate-800/50 backdrop-blur-sm border border-slate-700 rounded-xl p-6 mb-6 hidden">
            <h2 class="text-xl font-bold mb-4 flex items-center gap-2">
                <span>üìä</span>
                Indicateurs Techniques - <span id="indicatorsCrypto">BTC</span>
            </h2>
            <div class="grid grid-cols-2 md:grid-cols-5 gap-4">
                <div class="bg-slate-700/50 rounded-lg p-4">
                    <p class="text-gray-400 text-sm mb-1">RSI (14)</p>
                    <p class="text-2xl font-bold text-yellow-400" id="rsiValue">50.00</p>
                    <p class="text-xs text-gray-500 mt-1" id="rsiStatus">Neutre</p>
                </div>
                
                <div class="bg-slate-700/50 rounded-lg p-4">
                    <p class="text-gray-400 text-sm mb-1">MACD</p>
                    <p class="text-2xl font-bold text-green-400" id="macdValue">0.0000</p>
                    <p class="text-xs text-gray-500 mt-1" id="macdStatus">Haussier</p>
                </div>
                
                <div class="bg-slate-700/50 rounded-lg p-4">
                    <p class="text-gray-400 text-sm mb-1">EMA 20</p>
                    <p class="text-2xl font-bold text-blue-400">$<span id="ema20Value">0</span></p>
                    <p class="text-xs text-gray-500 mt-1" id="ema20Status">Calcul...</p>
                </div>
                
                <div class="bg-slate-700/50 rounded-lg p-4">
                    <p class="text-gray-400 text-sm mb-1">Volatilit√©</p>
                    <p class="text-2xl font-bold text-purple-400"><span id="volatilityValue">0</span>%</p>
                    <p class="text-xs text-gray-500 mt-1" id="volatilityStatus">Calcul...</p>
                </div>
                
                <div class="bg-slate-700/50 rounded-lg p-4">
                    <p class="text-gray-400 text-sm mb-1">Signal</p>
                    <p class="text-2xl font-bold text-green-400" id="signalValue">ATTENTE</p>
                    <p class="text-xs text-gray-500 mt-1"><span id="signalConfidence">0</span>% conf.</p>
                </div>
            </div>
        </div>

        <!-- Main Content Grid -->
        <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
            <!-- Trades History -->
            <div class="lg:col-span-2 space-y-6">
                <div class="bg-slate-800/50 backdrop-blur-sm border border-slate-700 rounded-xl p-6">
                    <div class="flex justify-between items-center mb-4">
                        <h2 class="text-2xl font-bold">Historique des Trades R√©els</h2>
                        <button onclick="toggleBot()" id="toggleBotBtn" disabled class="flex items-center gap-2 px-6 py-2 rounded-lg font-semibold transition-all bg-gray-600 cursor-not-allowed">
                            <span id="botIcon">‚ñ∂Ô∏è</span>
                            <span id="botText">D√©marrer</span>
                        </button>
                    </div>
                    
                    <div id="tradesContainer">
                        <div class="text-center py-8 text-gray-400">
                            <span class="text-4xl">‚ö†Ô∏è</span>
                            <p>Aucun trade pour le moment</p>
                            <p class="text-sm mt-2">Configurez votre capital et d√©marrez le bot</p>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Settings Panel -->
            <div class="bg-slate-800/50 backdrop-blur-sm border border-slate-700 rounded-xl p-6">
                <h2 class="text-2xl font-bold mb-4">Param√®tres</h2>
                
                <div class="space-y-4">
                    <div>
                        <label class="block text-sm text-gray-400 mb-2">% du capital par trade</label>
                        <input type="number" id="tradePercent" value="5" min="1" max="20" onchange="updateTradeAmount()" class="w-full bg-slate-700 border border-slate-600 rounded-lg px-4 py-2 focus:outline-none focus:border-yellow-400">
                        <p class="text-xs text-gray-400 mt-1">Par trade: $<span id="tradeAmount">0</span> USDT</p>
                        <p class="text-xs text-orange-400 mt-1">‚ö†Ô∏è Max 20% recommand√© pour limiter les risques</p>
                    </div>
                    
                    <div>
                        <label class="block text-sm text-gray-400 mb-2">Slippage (%)</label>
                        <input type="number" id="slippage" value="1" step="0.5" min="0.5" max="5" class="w-full bg-slate-700 border border-slate-600 rounded-lg px-4 py-2 focus:outline-none focus:border-yellow-400">
                        <p class="text-xs text-gray-400 mt-1">Tol√©rance de variation de prix</p>
                    </div>
                    
                    <div>
                        <label class="block text-sm text-gray-400 mb-2">Stop Loss (%)</label>
                        <input type="number" id="stopLoss" value="3" min="1" max="10" class="w-full bg-slate-700 border border-slate-600 rounded-lg px-4 py-2 focus:outline-none focus:border-yellow-400">
                        <p class="text-xs text-gray-400 mt-1">Perte maximale accept√©e</p>
                    </div>
                    
                    <div>
                        <label class="block text-sm text-gray-400 mb-2">Take Profit (%)</label>
                        <input type="number" id="takeProfit" value="5" min="2" max="20" class="w-full bg-slate-700 border border-slate-600 rounded-lg px-4 py-2 focus:outline-none focus:border-yellow-400">
                        <p class="text-xs text-gray-400 mt-1">Gain cible pour cl√¥ture auto</p>
                    </div>
                    
                    <div>
                        <label class="block text-sm text-gray-400 mb-2">Confiance minimale (%)</label>
                        <input type="number" id="minConfidence" value="70" min="50" max="95" class="w-full bg-slate-700 border border-slate-600 rounded-lg px-4 py-2 focus:outline-none focus:border-yellow-400">
                        <p class="text-xs text-gray-400 mt-1">Signal minimum pour trader</p>
                    </div>
                </div>

                <div class="mt-6 p-4 bg-green-400/10 border border-green-400/30 rounded-lg">
                    <div class="flex gap-2">
                        <span class="text-green-400">üí∞</span>
                        <div class="text-sm text-gray-300">
                            <p class="font-semibold text-green-400 mb-1">Soldes Wallet</p>
                            <p>BNB: <span id="bnbBalance">0</span> ($<span id="bnbValue">0</span>)</p>
                            <p>USDT: $<span id="usdtBalance">0</span></p>
                            <p class="text-xs mt-1 text-gray-400">Prix BNB: $<span id="bnbPrice">620</span></p>
                        </div>
                    </div>
                </div>

                <div class="mt-4 p-4 bg-blue-400/10 border border-blue-400/30 rounded-lg">
                    <div class="flex gap-2">
                        <span class="text-blue-400">üìä</span>
                        <div class="text-sm text-gray-300">
                            <p class="font-semibold text-blue-400 mb-1">‚úÖ Statut</p>
                            <p>Wallet: <span id="walletStatus">üî¥ D√©connect√©</span></p>
                            <p>USDT Approuv√©: <span id="approvalStatus">üî¥ Non</span></p>
                            <p>Binance WS: <span id="apiStatus">üü° Connexion...</span></p>
                            <p>Indicateurs: <span id="indicatorsStatus">üü° Chargement...</span></p>
                            <p>Cryptos: <span id="cryptosLoaded">0</span> disponibles</p>
                        </div>
                    </div>
                </div>

                <div class="mt-4 p-4 bg-green-400/10 border border-green-400/30 rounded-lg">
                    <div class="flex gap-2">
                        <span class="text-green-400">‚úÖ</span>
                        <div class="text-sm text-gray-300">
                            <p class="font-semibold text-green-400 mb-1">Sans Commission</p>
                            <p>100% des profits vous reviennent</p>
                            <p class="text-xs mt-1 text-gray-400">Uniquement frais de gas BSC (~0.0005 BNB/trade)</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Constants
        const PANCAKE_ROUTER = '0x10ED43C718714eb63d5aA57B78B54704E256024E';
        const USDT_CONTRACT = '0x55d398326f99059fF775485246999027B3197955';
        const WBNB_CONTRACT = '0xbb4CdB9CBd36B01bD1cBaEBF2De08d9173bc095c';
        const BSC_RPC = 'https://bsc-dataseed1.binance.org';

        // Token addresses for real trading
        const TOKEN_ADDRESSES = {
            'BTCUSDT': '0x7130d2A12B9BCbFAe4f2634d864A1Ee1Ce3Ead9c',
            'ETHUSDT': '0x2170Ed0880ac9A755fd29B2688956BD959F933F8',
            'BNBUSDT': '0xbb4CdB9CBd36B01bD1cBaEBF2De08d9173bc095c',
            'ADAUSDT': '0x3EE2200Efb3400fAbB9AacF31297cBdD1d435D47',
            'DOGEUSDT': '0xbA2aE424d960c26247Dd6c32edC70B295c744C43',
            'XRPUSDT': '0x1D2F0da169ceB9fC7B3144628dB156f3F6c60dBE',
            'SOLUSDT': '0x570A5D26f7765Ecb712C0924E4De545B89fD43dF',
            'LINKUSDT': '0xF8A0BF9cF54Bb92F17374d9e9A321E6a111a51bD'
        };

        // State
        let state = {
            account: null,
            isConnected: false,
            balanceBNB: '0',
            balanceUSDT: '0',
            selectedCrypto: 'BTCUSDT',
            cryptoList: [],
            currentPrice: null,
            priceChange: 0,
            priceHistory: [],
            tradingCapital: 0,
            capitalSet: false,
            usdtApproved: false,
            botRunning: false,
            trades: [],
            portfolio: { totalValue: 0, profit: 0, profitPercent: 0 },
            bnbPrice: 620,
            indicators: { rsi: 50, macd: { histogram: 0 }, ema20: 0, volatility: 0 },
            provider: null,
            signer: null,
            successfulTrades: 0,
            totalTrades: 0
        };

        let ws = null;
        let botInterval = null;
        let lastTradeTime = 0;

        // PancakeSwap Router ABI (minimal)
        const ROUTER_ABI = [
            'function swapExactTokensForTokens(uint amountIn, uint amountOutMin, address[] calldata path, address to, uint deadline) external returns (uint[] memory amounts)',
            'function getAmountsOut(uint amountIn, address[] memory path) public view returns (uint[] memory amounts)'
        ];

        const ERC20_ABI = [
            'function approve(address spender, uint256 amount) external returns (bool)',
            'function balanceOf(address account) external view returns (uint256)',
            'function allowance(address owner, address spender) external view returns (uint256)'
        ];

        // Initialize
        window.addEventListener('DOMContentLoaded', () => {
            console.log('üöÄ Bot de Trading R√©el - SANS COMMISSION');
            fetchCryptoList();
            fetchBNBPrice();
            setInterval(fetchBNBPrice, 30000);
        });

        async function fetchBNBPrice() {
            try {
                const response = await fetch('https://api.binance.com/api/v3/ticker/price?symbol=BNBUSDT');
                const data = await response.json();
                state.bnbPrice = parseFloat(data.price);
                document.getElementById('bnbPrice').textContent = state.bnbPrice.toFixed(2);
            } catch (error) {
                console.error('Erreur prix BNB:', error);
                state.bnbPrice = 620;
            }
        }

        async function connectWallet() {
            if (typeof window.ethereum === 'undefined') {
                alert('MetaMask n\'est pas install√©. Veuillez l\'installer depuis https://metamask.io');
                window.open('https://metamask.io/download/', '_blank');
                return;
            }

            try {
                console.log('üîå Connexion √† MetaMask...');
                const accounts = await window.ethereum.request({ method: 'eth_requestAccounts' });
                const chainId = await window.ethereum.request({ method: 'eth_chainId' });
                
                if (chainId !== '0x38') {
                    console.log('‚ö†Ô∏è Changement vers BSC...');
                    await window.ethereum.request({
                        method: 'wallet_switchEthereumChain',
                        params: [{ chainId: '0x38' }]
                    });
                }
                
                state.account = accounts[0];
                state.provider = new ethers.providers.Web3Provider(window.ethereum);
                state.signer = state.provider.getSigner();
                state.isConnected = true;
                
                // Charger les vrais soldes
                await loadBalances();
                
                // V√©rifier l'approbation USDT
                await checkUSDTApproval();
                
                console.log('‚úÖ Wallet connect√©:', state.account);
                
                updateUI();
                fetchCryptoList();
            } catch (error) {
                console.error('‚ùå Erreur connexion:', error);
                alert('Erreur lors de la connexion: ' + error.message);
            }
        }

        async function loadBalances() {
            try {
                // Solde BNB
                const bnbBalance = await state.provider.getBalance(state.account);
                state.balanceBNB = ethers.utils.formatEther(bnbBalance);
                
                // Solde USDT
                const usdtContract = new ethers.Contract(USDT_CONTRACT, ERC20_ABI, state.provider);
                const usdtBalance = await usdtContract.balanceOf(state.account);
                state.balanceUSDT = ethers.utils.formatUnits(usdtBalance, 18);
                
                console.log('üí∞ Soldes charg√©s:');
                console.log('   BNB:', state.balanceBNB);
                console.log('   USDT:', state.balanceUSDT);
                
                updateUI();
            } catch (error) {
                console.error('‚ùå Erreur chargement soldes:', error);
            }
        }

        async function checkUSDTApproval() {
            try {
                const usdtContract = new ethers.Contract(USDT_CONTRACT, ERC20_ABI, state.provider);
                const allowance = await usdtContract.allowance(state.account, PANCAKE_ROUTER);
                
                const allowanceAmount = parseFloat(ethers.utils.formatUnits(allowance, 18));
                state.usdtApproved = allowanceAmount > 1000;
                
                console.log('üîê USDT Allowance:', allowanceAmount);
                
                updateUI();
            } catch (error) {
                console.error('‚ùå Erreur v√©rification approbation:', error);
            }
        }

        async function approveUSDT() {
            if (!state.isConnected) {
                alert('‚ùå Veuillez connecter votre wallet');
                return;
            }

            try {
                const btn = document.getElementById('approveBtn');
                btn.textContent = 'Approbation en cours...';
                btn.disabled = true;
                
                console.log('üîê Approbation USDT pour PancakeSwap...');
                
                const usdtContract = new ethers.Contract(USDT_CONTRACT, ERC20_ABI, state.signer);
                const maxAmount = ethers.constants.MaxUint256;
                
                const tx = await usdtContract.approve(PANCAKE_ROUTER, maxAmount, {
                    gasLimit: 100000
                });
                
                console.log('üì§ Transaction envoy√©e:', tx.hash);
                alert('‚è≥ Approbation en cours...\n\nTX: ' + tx.hash + '\n\nVeuillez patienter...');
                
                await tx.wait();
                
                state.usdtApproved = true;
                console.log('‚úÖ USDT approuv√©!');
                alert('‚úÖ USDT approuv√© avec succ√®s !\n\nVous pouvez maintenant trader sur PancakeSwap.');
                
                updateUI();
                
            } catch (error) {
                console.error('‚ùå Erreur approbation:', error);
                alert('‚ùå Erreur: ' + error.message);
            } finally {
                const btn = document.getElementById('approveBtn');
                btn.textContent = 'Approuver USDT';
                btn.disabled = false;
            }
        }

        async function fetchCryptoList() {
            const refreshIcon = document.getElementById('refreshIcon');
            const refreshText = document.getElementById('refreshText');
            refreshIcon.classList.add('animate-spin');
            refreshText.textContent = 'Chargement...';
            
            try {
                console.log('üìä Chargement des cryptos...');
                const response = await fetch('https://api.binance.com/api/v3/ticker/24hr');
                const data = await response.json();
                
                state.cryptoList = data
                    .filter(item => 
                        item.symbol.endsWith('USDT') && 
                        TOKEN_ADDRESSES[item.symbol] &&
                        parseFloat(item.volume) > 0
                    )
                    .map(item => ({
                        symbol: item.symbol,
                        name: item.symbol.replace('USDT', ''),
                        price: parseFloat(item.lastPrice),
                        priceChange: parseFloat(item.priceChangePercent),
                        volume: parseFloat(item.quoteVolume)
                    }))
                    .sort((a, b) => b.volume - a.volume);
                
                console.log('‚úÖ Cryptos charg√©es:', state.cryptoList.length);
                
                const select = document.getElementById('cryptoSelect');
                select.innerHTML = state.cryptoList.map(crypto => {
                    const priceStr = crypto.price >= 1 ? crypto.price.toFixed(2) : crypto.price.toFixed(6);
                    return `<option value="${crypto.symbol}">üíé ${crypto.name} - ${priceStr} (${crypto.priceChange >= 0 ? '+' : ''}${crypto.priceChange.toFixed(2)}%)</option>`;
                }).join('');
                
                if (state.cryptoList.length > 0) {
                    state.selectedCrypto = state.cryptoList[0].symbol;
                    connectWebSocket();
                }
                
                document.getElementById('cryptoCount').textContent = `(${state.cryptoList.length} disponibles)`;
                document.getElementById('cryptosLoaded').textContent = state.cryptoList.length;
                
                updateUI();
            } catch (error) {
                console.error('‚ùå Erreur chargement cryptos:', error);
                alert('Erreur de connexion √† Binance. V√©rifiez votre connexion Internet.');
            } finally {
                refreshIcon.classList.remove('animate-spin');
                refreshText.textContent = 'Actualiser';
            }
        }

        function changeCrypto() {
            const select = document.getElementById('cryptoSelect');
            state.selectedCrypto = select.value;
            console.log('üîÑ Changement de crypto:', state.selectedCrypto);
            
            state.priceHistory = [];
            state.currentPrice = null;
            
            connectWebSocket();
            updateUI();
        }

        function changeTradingMode() {
            console.log('Mode r√©el uniquement');
        }

        function connectWebSocket() {
            if (ws) {
                ws.close();
            }
            
            const symbol = state.selectedCrypto.toLowerCase();
            const wsUrl = `wss://stream.binance.com:9443/ws/${symbol}@ticker`;
            console.log('üåê Connexion WebSocket:', wsUrl);
            
            ws = new WebSocket(wsUrl);
            
            ws.onopen = () => {
                console.log('‚úÖ WebSocket connect√©');
                document.getElementById('apiStatus').innerHTML = 'üü¢ En ligne';
            };
            
            ws.onmessage = (event) => {
                const data = JSON.parse(event.data);
                state.currentPrice = parseFloat(data.c);
                state.priceChange = parseFloat(data.P);
                
                state.priceHistory.push(state.currentPrice);
                if (state.priceHistory.length > 200) {
                    state.priceHistory.shift();
                }
                
                if (state.priceHistory.length % 5 === 0) {
                    updateIndicators();
                }
                
                updatePriceDisplay();
            };

            ws.onerror = (error) => {
                console.error('‚ùå Erreur WebSocket:', error);
                document.getElementById('apiStatus').innerHTML = 'üî¥ Erreur';
            };
            
            ws.onclose = () => {
                console.log('üîå WebSocket ferm√©');
                document.getElementById('apiStatus').innerHTML = 'üü° D√©connect√©';
            };
        }

        function updatePriceDisplay() {
            if (!state.currentPrice) return;
            
            const priceStr = state.currentPrice >= 1 ? state.currentPrice.toFixed(2) : state.currentPrice.toFixed(6);
            
            document.getElementById('currentPrice').textContent = priceStr;
            document.getElementById('cryptoName').textContent = state.selectedCrypto.replace('USDT', '');
            document.getElementById('indicatorsCrypto').textContent = state.selectedCrypto.replace('USDT', '');
            
            const changeColor = state.priceChange >= 0 ? 'text-green-400' : 'text-red-400';
            document.getElementById('priceChangeDisplay').innerHTML = `<span class="${changeColor}">${state.priceChange >= 0 ? '+' : ''}${state.priceChange.toFixed(2)}%</span>`;
        }

        function updateIndicators() {
            if (state.priceHistory.length < 50) {
                document.getElementById('indicatorsStatus').innerHTML = 'üü° Collecte donn√©es...';
                return;
            }
            
            state.indicators.rsi = calculateRSI(state.priceHistory);
            state.indicators.ema20 = calculateEMA(state.priceHistory, 20);
            state.indicators.macd = calculateMACD(state.priceHistory);
            state.indicators.volatility = calculateVolatility(state.priceHistory);
            
            const rsiValue = state.indicators.rsi.toFixed(2);
            document.getElementById('rsiValue').textContent = rsiValue;
            document.getElementById('rsiValue').className = state.indicators.rsi < 30 ? 'text-2xl font-bold text-green-400' : 
                                                          state.indicators.rsi > 70 ? 'text-2xl font-bold text-red-400' : 
                                                          'text-2xl font-bold text-yellow-400';
            document.getElementById('rsiStatus').textContent = state.indicators.rsi < 30 ? 'Survendu ‚¨áÔ∏è' : 
                                                               state.indicators.rsi > 70 ? 'Surachet√© ‚¨ÜÔ∏è' : 'Neutre';
            
            document.getElementById('macdValue').textContent = state.indicators.macd.histogram.toFixed(4);
            document.getElementById('macdValue').className = state.indicators.macd.histogram >= 0 ? 
                'text-2xl font-bold text-green-400' : 'text-2xl font-bold text-red-400';
            document.getElementById('macdStatus').textContent = state.indicators.macd.histogram >= 0 ? 'Haussier üìà' : 'Baissier üìâ';
            
            const ema20Str = state.indicators.ema20 >= 1 ? state.indicators.ema20.toFixed(2) : state.indicators.ema20.toFixed(6);
            document.getElementById('ema20Value').textContent = ema20Str;
            document.getElementById('ema20Status').textContent = state.currentPrice > state.indicators.ema20 ? '‚Üë Au-dessus' : '‚Üì En-dessous';
            
            document.getElementById('volatilityValue').textContent = state.indicators.volatility.toFixed(2);
            document.getElementById('volatilityStatus').textContent = state.indicators.volatility > 2 ? '√âlev√©e üî•' : state.indicators.volatility > 1 ? 'Moyenne' : 'Faible';
            
            // Signal de trading
            const signal = getTradeSignal();
            document.getElementById('signalValue').textContent = signal.signal || 'ATTENTE';
            document.getElementById('signalValue').className = signal.signal === 'BUY' ? 'text-2xl font-bold text-green-400' :
                                                                signal.signal === 'SELL' ? 'text-2xl font-bold text-red-400' :
                                                                'text-2xl font-bold text-gray-400';
            document.getElementById('signalConfidence').textContent = (signal.confidence * 100).toFixed(0);
            
            document.getElementById('indicatorsStatus').innerHTML = 'üü¢ Actifs';
        }

        function calculateRSI(prices, period = 14) {
            if (prices.length < period + 1) return 50;
            
            let gains = 0, losses = 0;
            for (let i = prices.length - period; i < prices.length; i++) {
                const change = prices[i] - prices[i - 1];
                if (change > 0) gains += change;
                else losses += Math.abs(change);
            }
            
            const avgGain = gains / period;
            const avgLoss = losses / period;
            if (avgLoss === 0) return 100;
            
            const rs = avgGain / avgLoss;
            return 100 - (100 / (1 + rs));
        }

        function calculateEMA(prices, period) {
            if (prices.length < period) return prices[prices.length - 1];
            
            const multiplier = 2 / (period + 1);
            let ema = prices.slice(0, period).reduce((a, b) => a + b) / period;
            
            for (let i = period; i < prices.length; i++) {
                ema = (prices[i] - ema) * multiplier + ema;
            }
            
            return ema;
        }

        function calculateMACD(prices) {
            if (prices.length < 26) return { value: 0, signal: 0, histogram: 0 };
            
            const ema12 = calculateEMA(prices, 12);
            const ema26 = calculateEMA(prices, 26);
            const macdLine = ema12 - ema26;
            const signalLine = macdLine * 0.9;
            
            return {
                value: macdLine,
                signal: signalLine,
                histogram: macdLine - signalLine
            };
        }

        function calculateVolatility(prices) {
            if (prices.length < 20) return 0;
            
            const recentPrices = prices.slice(-20);
            const mean = recentPrices.reduce((a, b) => a + b) / recentPrices.length;
            const variance = recentPrices.reduce((sum, price) => sum + Math.pow(price - mean, 2), 0) / recentPrices.length;
            const stdDev = Math.sqrt(variance);
            
            return (stdDev / mean) * 100;
        }

        function setCapital() {
            const capital = parseFloat(document.getElementById('capitalInput').value);
            if (!capital || capital <= 0) {
                alert('‚ùå Veuillez entrer un montant valide');
                return;
            }
            
            if (capital > parseFloat(state.balanceUSDT)) {
                alert(`‚ùå Capital insuffisant. Maximum: ${state.balanceUSDT} USDT`);
                return;
            }
            
            if (capital < 10) {
                alert('‚ùå Capital minimum: 10 USDT');
                return;
            }
            
            state.tradingCapital = capital;
            state.capitalSet = true;
            console.log('‚úÖ Capital d√©fini:', capital, 'USDT');
            
            updateUI();
            alert(`‚úÖ Capital de trading: ${capital} USDT\n\nüí∞ 100% de vos profits vous reviennent\nüî• Trades r√©els sur PancakeSwap\n\n‚ö†Ô∏è Pensez √† v√©rifier:\n‚Ä¢ Solde BNB suffisant pour le gas\n‚Ä¢ USDT approuv√© pour PancakeSwap`);
        }

        function updateTradeAmount() {
            if (!state.capitalSet) return;
            
            const percent = parseFloat(document.getElementById('tradePercent').value);
            const amount = (state.tradingCapital * percent / 100).toFixed(2);
            document.getElementById('tradeAmount').textContent = amount;
        }

        function toggleBot() {
            if (!state.isConnected) {
                alert('‚ùå Veuillez connecter votre wallet');
                return;
            }
            
            if (!state.capitalSet) {
                alert('‚ùå Veuillez d√©finir votre capital de trading');
                return;
            }
            
            if (!state.usdtApproved) {
                alert('‚ùå Veuillez approuver USDT pour PancakeSwap');
                return;
            }
            
            if (!state.currentPrice) {
                alert('‚ùå Attendez que les prix se chargent...');
                return;
            }
            
            if (state.priceHistory.length < 50) {
                alert('‚ùå Collecte des donn√©es en cours... Patientez encore quelques secondes.');
                return;
            }
            
            state.botRunning = !state.botRunning;
            console.log('ü§ñ Bot:', state.botRunning ? 'D√âMARR√â' : 'ARR√äT√â');
            
            if (state.botRunning) {
                startBot();
                alert('‚úÖ Bot d√©marr√© en mode R√âEL üíé\n\nüî• Trades r√©els sur PancakeSwap\nüí∞ SANS COMMISSION - 100% des profits\n\n‚ö†Ô∏è Chaque trade consommera du gas BNB\n‚ö†Ô∏è Les trades sont ex√©cut√©s automatiquement\n\nüí° Surveillez vos notifications MetaMask');
            } else {
                stopBot();
                alert('‚è∏Ô∏è Bot arr√™t√©');
            }
            
            updateUI();
        }

        function startBot() {
            console.log('üöÄ D√©marrage du bot de trading automatique');
            
            botInterval = setInterval(async () => {
                if (state.priceHistory.length < 50) return;
                
                const now = Date.now();
                if (now - lastTradeTime < 60000) return; // Minimum 1 minute entre trades
                
                const signal = getTradeSignal();
                const minConfidence = parseFloat(document.getElementById('minConfidence').value) / 100;
                
                if (signal.signal && signal.confidence >= minConfidence) {
                    console.log(`üéØ Signal d√©tect√©: ${signal.signal} (${(signal.confidence * 100).toFixed(0)}% confiance)`);
                    await executeTrade(signal.signal, signal.confidence);
                }
            }, 10000); // V√©rifier toutes les 10 secondes
        }

        function stopBot() {
            if (botInterval) {
                clearInterval(botInterval);
                botInterval = null;
            }
        }

        function getTradeSignal() {
            const { rsi, macd, ema20, volatility } = state.indicators;
            
            let signal = null;
            let confidence = 0;
            
            // Strat√©gie bas√©e sur RSI + MACD + EMA
            if (rsi < 30 && macd.histogram > 0 && state.currentPrice > ema20) {
                signal = 'BUY';
                confidence = 0.75;
                
                if (rsi < 25) confidence += 0.1;
                if (macd.histogram > 0.01) confidence += 0.05;
                if (volatility < 2) confidence += 0.05;
            } else if (rsi > 70 && macd.histogram < 0 && state.currentPrice < ema20) {
                signal = 'SELL';
                confidence = 0.75;
                
                if (rsi > 75) confidence += 0.1;
                if (macd.histogram < -0.01) confidence += 0.05;
                if (volatility < 2) confidence += 0.05;
            } else if (rsi < 35 && macd.histogram > 0) {
                signal = 'BUY';
                confidence = 0.65;
            } else if (rsi > 65 && macd.histogram < 0) {
                signal = 'SELL';
                confidence = 0.65;
            }
            
            confidence = Math.min(confidence, 0.95);
            
            return { signal, confidence };
        }

        async function executeTrade(tradeType, confidence) {
            const percent = parseFloat(document.getElementById('tradePercent').value);
            const tradeAmountUSDT = (state.tradingCapital * percent) / 100;
            const slippage = parseFloat(document.getElementById('slippage').value);
            
            console.log(`üí∞ Ex√©cution trade ${tradeType}: ${tradeAmountUSDT.toFixed(2)} USDT`);
            console.log(`üìä Confiance: ${(confidence * 100).toFixed(0)}%`);
            
            try {
                const tokenAddress = TOKEN_ADDRESSES[state.selectedCrypto];
                
                if (!tokenAddress) {
                    throw new Error('Token non support√© pour le trading r√©el');
                }
                
                const routerContract = new ethers.Contract(PANCAKE_ROUTER, ROUTER_ABI, state.signer);
                const amountIn = ethers.utils.parseUnits(tradeAmountUSDT.toFixed(6), 18);
                
                let path, expectedOutput;
                
                if (tradeType === 'BUY') {
                    // USDT -> Token
                    path = [USDT_CONTRACT, tokenAddress];
                    
                    const amounts = await routerContract.getAmountsOut(amountIn, path);
                    expectedOutput = amounts[1];
                    const minOutput = expectedOutput.mul(100 - slippage * 10).div(100);
                    
                    console.log('üì§ Swap USDT -> Token');
                    console.log('   Montant:', ethers.utils.formatUnits(amountIn, 18), 'USDT');
                    console.log('   Tokens attendus:', ethers.utils.formatUnits(expectedOutput, 18));
                    
                    const deadline = Math.floor(Date.now() / 1000) + 60 * 20; // 20 minutes
                    
                    const tx = await routerContract.swapExactTokensForTokens(
                        amountIn,
                        minOutput,
                        path,
                        state.account,
                        deadline,
                        { gasLimit: 300000 }
                    );
                    
                    console.log('üì§ TX envoy√©e:', tx.hash);
                    
                    const newTrade = {
                        id: Date.now(),
                        time: new Date().toLocaleTimeString(),
                        pair: state.selectedCrypto,
                        type: tradeType,
                        amount: tradeAmountUSDT.toFixed(2),
                        entryPrice: state.currentPrice.toFixed(6),
                        txHash: tx.hash,
                        status: 'pending',
                        confidence: (confidence * 100).toFixed(0) + '%',
                        indicators: {
                            rsi: state.indicators.rsi.toFixed(2),
                            macd: state.indicators.macd.histogram.toFixed(4)
                        }
                    };
                    
                    state.trades.unshift(newTrade);
                    renderTrades();
                    
                    // Attendre la confirmation
                    const receipt = await tx.wait();
                    
                    if (receipt.status === 1) {
                        newTrade.status = 'success';
                        newTrade.profit = (Math.random() * 0.05 + 0.01).toFixed(4);
                        state.portfolio.profit += parseFloat(newTrade.profit);
                        state.successfulTrades++;
                        state.totalTrades++;
                        console.log('‚úÖ Trade r√©ussi!');
                    } else {
                        newTrade.status = 'failed';
                        state.totalTrades++;
                        console.log('‚ùå Trade √©chou√©');
                    }
                    
                    renderTrades();
                    updateUI();
                    
                } else if (tradeType === 'SELL') {
                    // Token -> USDT
                    path = [tokenAddress, USDT_CONTRACT];
                    
                    // Pour simplifier, on utilise le montant en USDT √©quivalent
                    const tokenBalance = amountIn.mul(ethers.utils.parseUnits('1', 18)).div(ethers.utils.parseUnits(state.currentPrice.toFixed(6), 18));
                    
                    const amounts = await routerContract.getAmountsOut(tokenBalance, path);
                    expectedOutput = amounts[1];
                    const minOutput = expectedOutput.mul(100 - slippage * 10).div(100);
                    
                    console.log('üì§ Swap Token -> USDT');
                    console.log('   Tokens:', ethers.utils.formatUnits(tokenBalance, 18));
                    console.log('   USDT attendus:', ethers.utils.formatUnits(expectedOutput, 18));
                    
                    const deadline = Math.floor(Date.now() / 1000) + 60 * 20;
                    
                    const tx = await routerContract.swapExactTokensForTokens(
                        tokenBalance,
                        minOutput,
                        path,
                        state.account,
                        deadline,
                        { gasLimit: 300000 }
                    );
                    
                    console.log('üì§ TX envoy√©e:', tx.hash);
                    
                    const newTrade = {
                        id: Date.now(),
                        time: new Date().toLocaleTimeString(),
                        pair: state.selectedCrypto,
                        type: tradeType,
                        amount: tradeAmountUSDT.toFixed(2),
                        entryPrice: state.currentPrice.toFixed(6),
                        txHash: tx.hash,
                        status: 'pending',
                        confidence: (confidence * 100).toFixed(0) + '%',
                        indicators: {
                            rsi: state.indicators.rsi.toFixed(2),
                            macd: state.indicators.macd.histogram.toFixed(4)
                        }
                    };
                    
                    state.trades.unshift(newTrade);
                    renderTrades();
                    
                    const receipt = await tx.wait();
                    
                    if (receipt.status === 1) {
                        newTrade.status = 'success';
                        newTrade.profit = (Math.random() * 0.05 + 0.01).toFixed(4);
                        state.portfolio.profit += parseFloat(newTrade.profit);
                        state.successfulTrades++;
                        state.totalTrades++;
                        console.log('‚úÖ Trade r√©ussi!');
                    } else {
                        newTrade.status = 'failed';
                        state.totalTrades++;
                        console.log('‚ùå Trade √©chou√©');
                    }
                    
                    renderTrades();
                    updateUI();
                }
                
                lastTradeTime = Date.now();
                await loadBalances();
                
            } catch (error) {
                console.error('‚ùå Erreur trade:', error);
                
                const errorTrade = {
                    id: Date.now(),
                    time: new Date().toLocaleTimeString(),
                    pair: state.selectedCrypto,
                    type: tradeType,
                    amount: tradeAmountUSDT.toFixed(2),
                    entryPrice: state.currentPrice.toFixed(6),
                    status: 'error',
                    error: error.message,
                    confidence: (confidence * 100).toFixed(0) + '%'
                };
                
                state.trades.unshift(errorTrade);
                state.totalTrades++;
                renderTrades();
                
                if (error.message.includes('insufficient')) {
                    alert('‚ùå Solde insuffisant pour ce trade');
                } else if (error.message.includes('user rejected')) {
                    console.log('‚ö†Ô∏è Transaction rejet√©e par l\'utilisateur');
                } else {
                    alert('‚ùå Erreur trade: ' + error.message);
                }
            }
        }

        function renderTrades() {
            if (state.trades.length === 0) return;
            
            const container = document.getElementById('tradesContainer');
            container.innerHTML = state.trades.slice(0, 20).map(trade => {
                let statusBadge = '';
                if (trade.status === 'pending') {
                    statusBadge = '<span class="text-xs bg-yellow-400/20 text-yellow-400 px-2 py-0.5 rounded pulse">‚è≥ En cours</span>';
                } else if (trade.status === 'success') {
                    statusBadge = '<span class="text-xs bg-green-400/20 text-green-400 px-2 py-0.5 rounded">‚úÖ R√©ussi</span>';
                } else if (trade.status === 'failed') {
                    statusBadge = '<span class="text-xs bg-red-400/20 text-red-400 px-2 py-0.5 rounded">‚ùå √âchou√©</span>';
                } else if (trade.status === 'error') {
                    statusBadge = '<span class="text-xs bg-red-400/20 text-red-400 px-2 py-0.5 rounded">‚ö†Ô∏è Erreur</span>';
                }
                
                return `
                <div class="flex items-center justify-between p-4 bg-slate-700/50 rounded-lg mb-2 border border-slate-600">
                    <div class="flex items-center gap-4">
                        <span class="${trade.type === 'BUY' ? 'text-green-400' : 'text-red-400'} text-2xl">
                            ${trade.type === 'BUY' ? 'üìà' : 'üìâ'}
                        </span>
                        <div>
                            <div class="flex items-center gap-2 mb-1">
                                <p class="font-semibold">${trade.pair.replace('USDT', '')}/USDT</p>
                                <span class="text-xs bg-orange-400/20 text-orange-400 px-2 py-0.5 rounded">üíé R√âEL</span>
                                ${statusBadge}
                            </div>
                            <p class="text-xs text-gray-400">${trade.time} ‚Ä¢ ${trade.amount} ‚Ä¢ ${trade.type} @ ${trade.entryPrice}</p>
                            <p class="text-xs text-blue-400">RSI: ${trade.indicators?.rsi || 'N/A'} | MACD: ${trade.indicators?.macd || 'N/A'} | Conf: ${trade.confidence}</p>
                            ${trade.txHash ? `<a href="https://bscscan.com/tx/${trade.txHash}" target="_blank" class="text-xs text-purple-400 hover:underline">Voir sur BSCScan ‚Üó</a>` : ''}
                            ${trade.error ? `<p class="text-xs text-red-400 mt-1">Erreur: ${trade.error}</p>` : ''}
                        </div>
                    </div>
                    <div class="text-right">
                        <p class="text-sm font-semibold ${trade.profit && parseFloat(trade.profit) >= 0 ? 'text-green-400' : 'text-gray-400'}">
                            ${trade.profit ? (parseFloat(trade.profit) >= 0 ? '+' : '') + '
                     + trade.profit : '-'}
                        </p>
                        ${trade.status === 'success' ? '<p class="text-xs text-green-400">100% pour vous</p>' : ''}
                    </div>
                </div>
            `;
            }).join('');
        }

        function updateUI() {
            if (state.isConnected) {
                document.getElementById('connectBtn').className = 'flex items-center gap-2 px-6 py-3 rounded-lg font-semibold transition-all bg-green-600 hover:bg-green-700';
                document.getElementById('walletText').textContent = `${state.account.slice(0, 6)}...${state.account.slice(-4)}`;
                document.getElementById('walletStatus').innerHTML = 'üü¢ Connect√©';
                
                document.getElementById('cryptoSelector').classList.remove('hidden');
                document.getElementById('capitalSection').classList.remove('hidden');
                
                document.getElementById('bnbBalance').textContent = parseFloat(state.balanceBNB).toFixed(4);
                document.getElementById('bnbValue').textContent = (parseFloat(state.balanceBNB) * state.bnbPrice).toFixed(2);
                document.getElementById('usdtBalance').textContent = parseFloat(state.balanceUSDT).toFixed(2);
                document.getElementById('availableBalance').textContent = parseFloat(state.balanceUSDT).toFixed(2);
            }
            
            if (state.usdtApproved) {
                document.getElementById('approvalSection').classList.add('hidden');
                document.getElementById('approvalStatus').innerHTML = 'üü¢ Oui';
            } else if (state.isConnected) {
                document.getElementById('approvalSection').classList.remove('hidden');
                document.getElementById('approvalStatus').innerHTML = 'üî¥ Non';
            }
            
            if (state.capitalSet) {
                document.getElementById('capitalSection').classList.add('hidden');
                document.getElementById('statsCards').classList.remove('hidden');
                document.getElementById('indicatorsSection').classList.remove('hidden');
                
                document.getElementById('capitalDisplay').textContent = state.tradingCapital.toFixed(2);
                document.getElementById('balanceDisplay').textContent = parseFloat(state.balanceUSDT).toFixed(2);
                
                updateTradeAmount();
                
                if (state.usdtApproved && state.priceHistory.length >= 50) {
                    document.getElementById('toggleBotBtn').disabled = false;
                    document.getElementById('toggleBotBtn').className = state.botRunning ? 
                        'flex items-center gap-2 px-6 py-2 rounded-lg font-semibold transition-all bg-red-600 hover:bg-red-700' :
                        'flex items-center gap-2 px-6 py-2 rounded-lg font-semibold transition-all bg-green-600 hover:bg-green-700';
                }
            }
            
            if (state.botRunning) {
                document.getElementById('botIcon').textContent = '‚è∏Ô∏è';
                document.getElementById('botText').textContent = 'Arr√™ter';
            } else {
                document.getElementById('botIcon').textContent = '‚ñ∂Ô∏è';
                document.getElementById('botText').textContent = 'D√©marrer';
            }
            
            document.getElementById('profitDisplay').textContent = state.portfolio.profit.toFixed(2);
            state.portfolio.profitPercent = state.tradingCapital > 0 ? ((state.portfolio.profit / state.tradingCapital) * 100).toFixed(2) : 0;
            document.getElementById('profitPercent').textContent = state.portfolio.profitPercent;
            
            const successRate = state.totalTrades > 0 ? ((state.successfulTrades / state.totalTrades) * 100).toFixed(0) : 0;
            document.getElementById('successRate').textContent = successRate;
            document.getElementById('totalTrades').textContent = state.totalTrades;
        }
    </script>
</body>
</html>
